export class BarGraph{#a;#b;#c;#d;#e;#f;#g;#h=!1;#i=!1;#j=!0;#k=!0;#l;#m;#n;#o;#p;#q;#r;#s=720;#t=480;#u={l:60,r:60,t:40,b:40};#v=.25;#w;#x=12;get data(){return this.#a}get cSeries(){return this.#b}get nSeries(){return this.#c}get tooltipSeries(){return this.#d}get graphTitle(){return this.#e}get cAxisTitle(){return this.#f}get nAxisTitle(){return this.#g}get vertical(){return this.#h}get grouped(){return this.#i}get tooltips(){return this.#j}get barLabels(){return this.#k}get container(){return this.#l}get wrapper(){return this.#m}get axisGens(){return this.#n}get stackGen(){return this.#o}get stackData(){return this.#p}get cScale(){return this.#q}get nScale(){return this.#r}get width(){return this.#s}get height(){return this.#t}get margins(){return this.#u}get padding(){return this.#v}get legendRadius(){return this.#x}get barWidth(){return this.#w}set data(t){let e="object"==typeof t&&t.length>0,i=!0;if(e){for(let s of t)if("object"!=typeof s||Object.keys(s).length<2){i=!1;break}}e&&i?this.#a=t:console.error("Data must be an array of object(s) with 2+ fields")}set cSeries(t){"string"==typeof t&&t?this.#b=t:console.error("cSeries must be a non-empty string")}set nSeries(t){let e="object"==typeof t&&t.length>0,i=!0;if(e){for(let s of t)if("string"!=typeof s||!s){i=!1;break}}e&&i?this.#c=t:console.error("nSeries must be an array of non-empty string(s)")}set tooltipSeries(t){let e="object"==typeof t&&t.length>0,i=!0;if(e){for(let s of t)if("string"!=typeof s||!s){i=!1;break}}e&&i?this.#d=t:console.error("tooltipSeries must be an array of non-empty string(s)")}set graphTitle(t){"string"==typeof t&&t?this.#e=t:console.error("graphTitle must be a non-empty string")}set cAxisTitle(t){"string"==typeof t&&t?this.#f=t:console.error("cAxisTitle must be a non-empty string")}set nAxisTitle(t){"string"==typeof t&&t?this.#g=t:console.error("nAxisTitle must be a non-empty string")}set vertical(t){"boolean"==typeof t?this.#h=t:console.error("vertical must be a boolean")}set grouped(t){"boolean"==typeof t?this.#i=t:console.error("grouped must be a boolean")}set tooltips(t){"boolean"==typeof t?this.#j=t:console.error("tooltips must be a boolean")}set barLabels(t){"boolean"==typeof t?this.#k=t:console.error("barLabels must be a boolean")}set legendRadius(t){"number"==typeof t&&t>=0?this.#x=t:console.error("radius must be a non-negative number")}set barWidth(t){"number"==typeof t&&t>=0?this.#w=t:console.error("barWidth must be a non-negative number")}set width(t){"number"==typeof t&&t>=0?this.#s=t:console.error("width must be a non-negative number")}set height(t){"number"==typeof t&&t>=0?this.#t=t:console.error("height must be a non-negative number")}set margins(t){let e=!0;for(let i of t)if("number"!=typeof i){e=!1;break}e?this.#u={l:t[3],r:t[1],t:t[0],b:t[2]}:console.error("Please input an array of four numbers to configure top,right, bottom, and left margins in that order.")}set padding(t){"number"==typeof t&&t<=1&&t>=0?this.#v=t:console.error("padding must be a decimal percentage between 0-1")}set axisGens(t){this.#n={c:t[0],n:t[1]}}set stackGen(t){this.#o=t}set stackData(t){this.#p=t}set cScale(t){this.#q=t}set nScale(t){this.#r=t}set container(t){this.#l=t}set wrapper(t){this.#m=t}initStack(){this.#o=d3.stack().keys(this.#c),this.#p=this.#o(this.#a)}initNScale(t=!1){let[e,i]=this.dataMinMax();t?this.#r=d3.scaleLog().domain([e>.001?e:.001,i]).range([0,this.#t-this.#u.b-this.#u.t]):this.#r=d3.scaleLinear().domain([0,i]).range([this.#t-this.#u.b,this.#u.t]),this.#h||(this.#r=this.#r.range([this.#u.l,this.#s-this.#u.l-this.#u.r]))}initCScale(){this.#q=d3.scaleBand().domain(this.#a.map(t=>t[this.#b])).range([this.#u.l,this.#s-this.#u.l-this.#u.r]),this.#h||(this.#q=this.#q.range([this.#u.t,this.#t-this.#u.b]))}initAxes(t={},e={}){let i=d3.axisLeft(this.#r),s=d3.axisBottom(this.#q);function a(t,e){e.ticks&&t.ticks(e.ticks),e.tickValues&&t.tickValues(e.tickValues),e.tickFormat&&t.tickFormat(e.tickFormat),e.tickPadding&&t.tickPadding(e.tickPadding),e.tickSize&&t.tickSize(e.tickSize)}this.#h||(i=d3.axisBottom(this.#r),s=d3.axisLeft(this.#q)),a(i,e),a(s,t),this.#n={c:s,n:i}}initBarWidth(){let t=this.#a.length;this.#i&&(t*=this.#c.length);let e=(this.#s-this.#u.l-this.#u.r)/t;this.#h||(e=(this.#t-this.#u.t-this.#u.b)/t),this.#w=e*(1-this.#v)}init(){this.initStack(),this.initNScale(),this.initCScale(),this.initAxes(),this.initBarWidth()}clear(){this.#m.select("div.tooltip").remove(),this.#l.selectAll("*").remove()}render(){this.#y(),this.#z();let t,e,i;this.#j&&([t,e,i]=this.#A()),this.#B(t,e,i),this.#C()}#B(t,e,i){let s=this.#l.append("g").attr("class","bars"),a=this.#b,r=this.#c,n=this.#r,h=this.#q,l=this.#w,c=this.#s,o=this.#k,g=this.#h,d=g?"x":"y",p=g?"y":"x",m=g?"height":"width",u=g?"width":"height",b=this.#h?0:1,f=this.#h?1:0;this.#i?s.selectAll("g").data(this.#a).join("g").each(function(s){let b=[];Object.keys(s).forEach(t=>{r.includes(t)&&b.push({cat:s[a],type:t,val:s[t]})}),d3.select(this).append("g").attr("class","background").append("rect").attr(d,h(s[a])).attr(p,n(0)).attr(m,c-n(0)).attr(u,l*b.length).attr("fill","white"),d3.select(this).append("g").attr("class","foreground").selectAll("rect").data(b).join("rect").attr(d,(t,e)=>h(t.cat)+e*l).attr(p,n(0)).attr(m,t=>n(t.val)-n(0)).attr(u,l).attr("class",t=>t.type),o&&d3.select(this).selectAll("text").data(b).join("text").attr("class","bar-label").attr(d,(t,e)=>h(t.cat)+(e+1)*l-l/3.2).attr(p,t=>{let e="number"!=typeof t.val?0:t.val;return n(e)+(g?-10:10)}).text(t=>"number"!=typeof t.val?"NA":t.val),d3.select(this).on("mouseenter",t).on("mouseleave",e).on("mousemove",i)}):s.selectAll("g").data(this.#p).join("g").attr("class",t=>t.key).each(function(s){d3.select(this).selectAll("rect").data(s).join("rect").attr(d,t=>h(t.data[a])).attr(p,t=>n(t[f])).attr(m,t=>n(t[b])-n(t[f])).attr(u,l).on("mouseenter",t).on("mouseleave",e).on("mousemove",i),o&&d3.select(this).selectAll("text").data(s).join("text").attr("class","bar-label").attr(d,t=>h(t.data[a])).attr(p,t=>{let e="number"!=typeof t[f]?0:t[f];return n(e)+(g?-10:10)}).text(t=>"number"!=typeof t[f]?"NA":t[f])})}#C(){let $=this.#l.append("g").attr("class","axes"),x=this.#h?"n":"c";$.append("g").attr("class",x).attr("transform",`translate(${this.#u.l},0)`).call(this.#n[x]);let y=this.#h?"c":"n",S=(this.#h,this.#t-this.#u.b);$.append("g").attr("class",y).attr("transform",`translate(0, ${S})`).call(this.#n[y])}#y(){let k=this.#l.append("g").attr("class","titles");k.append("text").attr("class","graph-title").attr("x",this.#u.l+(this.#s-this.#u.l)/2).attr("y",this.#h?this.#u.t/2:this.#u.t/4).attr("text-anchor","middle").text(this.#e);let v=this.#h?"n":"c",_=this.#h?this.#u.l/2.5:40;k.append("text").attr("class",v+"-axis-title").attr("x",_).attr("y",this.#u.t+(this.#t-this.#u.t-this.#u.b)/2).attr("text-anchor","middle").attr("transform",`rotate(-90, ${_}, 
          ${this.#u.t+(this.#t-this.#u.t-this.#u.b)/2} )`).text(this.#h?this.#g:this.#f);let A=this.#h?this.#t-this.#u.b/1.75:this.#t-this.#u.b/3,w=this.#h?"c":"n";k.append("text").attr("class",w+"-axis-title").attr("x",this.#u.l+(this.#s-this.#u.l-this.#u.r)/2.25).attr("y",A).attr("text-anchor","end").text(this.#h?this.#f:this.#g)}#z(){let T=this.#l.append("g").attr("class","legend"),G=this.#x,j=this.#h?this.#t-this.#u.b/2:this.#u.t/2,D=4*G;T.selectAll("circle").data(this.#p).join("circle").attr("r",G).attr("cx",(t,e)=>.35*this.#s+2*G+16*e*G).attr("cy",j).attr("class",t=>t.key),T.selectAll("text").data(this.#p).join("text").attr("class",t=>t.key).attr("text-anchor","start").attr("x",(t,e)=>.35*this.#s+D+16*e*G).attr("y",j+.3*G).text(t=>t.key)}#A(){let L=this.#d?this.#d:[this.#b,...this.#c],W=this.#m.append("div").attr("class","tooltip").style("opacity",0);return[function t(e,i){Object.keys(i).includes("data")||(i.data=i);let s="";for(let a of L)s+=a.charAt(0).toUpperCase()+a.slice(1),s+=": "+(null!==i.data[a]?i.data[a]:"NA"),s+=" <br /> ";W.html(s).style("opacity",1)},function t(e,i){W.style("opacity",0)},function t(e,i){W.style("transform","translateX(25px)").style("left",`${e.clientX}px`).style("top",`${e.clientY}px`)}]}dataMinMax(){let t,e;if(!0!==this.#i){let i=this.#p[0],s=this.#p[this.#p.length-1];t=i[0][0];for(let a=0;a<i.length;a++)i[a][0]<t&&(t=i[a][0]);e=s[0][1];for(let r=0;r<s.length;r++)s[r][1]>e&&(e=s[r][1])}else{t=this.#a[0][this.#c[0]],e=this.#a[0][this.#c[0]];for(let n=this.#a.length-1;n>-1;n--)for(let h=this.#c.length-1;h>-1;h--){let l=this.#a[n][this.#c[h]];l>e&&(e=l),l<t&&(t=l)}}return[t,e]}}